<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    .patsyntax {color:#808080;background-color:#E0E0E0;}
    .patsyntax span.keyword {color:#000000;font-weight:bold;}
    .patsyntax span.comment {color:#787878;font-style:italic;}
    .patsyntax span.extcode {color:#A52A2A;}
    .patsyntax span.neuexp  {color:#800080;}
    .patsyntax span.staexp  {color:#0000F0;}
    .patsyntax span.prfexp  {color:#603030;}
    .patsyntax span.dynexp  {color:#F00000;}
    .patsyntax span.stalab  {color:#0000F0;font-style:italic}
    .patsyntax span.dynlab  {color:#F00000;font-style:italic}
    .patsyntax span.dynstr  {color:#008000;font-style:normal}
    .patsyntax span.stacstdec  {text-decoration:none;}
    .patsyntax span.stacstuse  {color:#0000CF;text-decoration:underline;}
    .patsyntax span.dyncstdec  {text-decoration:none;}
    .patsyntax span.dyncstuse  {color:#B80000;text-decoration:underline;}
    .patsyntax span.dyncst_implement  {color:#B80000;text-decoration:underline;}
  </style>
</head>
<body class="patsyntax">
<pre class="patsyntax">
<span class="comment">(* ****** ****** *)</span>
<span class="comment">//</span>
<span class="neuexp"><span class="keyword">#include</span>
"share/atspre_staload.hats"</span>
<span class="neuexp"><span class="keyword">#include</span>
"share/HATS/atspre_staload_libats_ML.hats"</span>
<span class="comment">//</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">typedef</span> <span class="staexp">intlist <span class="keyword">=</span> <span class="staexp">list0</span> <span class="keyword">(</span><span class="staexp">int</span><span class="keyword">)</span></span>

<span class="comment">(* ****** ****** *)</span>

<span class="dynexp"><span class="keyword">fun</span> mult
  <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp">list0</span> <span class="keyword">(</span><span class="staexp">int</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">int</span> <span class="keyword">=</span>
<span class="keyword">(</span>
<span class="keyword">case+</span> xs <span class="keyword">of</span>
<span class="keyword">|</span> cons0 <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> x * mult <span class="keyword">(</span>xs<span class="keyword">)</span> <span class="keyword">|</span> nil0 <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="dynexp">1</span>
<span class="keyword">)</span></span>

<span class="comment">(* ****** ****** *)</span>

<span class="dynexp"><span class="keyword">fun</span> mult2
  <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp">list0</span> <span class="keyword">(</span><span class="staexp">int</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">int</span> <span class="keyword">=</span>
<span class="keyword">(</span>
<span class="keyword">case+</span> xs <span class="keyword">of</span>
<span class="keyword">|</span> cons0 <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span>
    <span class="keyword">if</span> x <span class="keyword">=</span> <span class="dynexp">0</span> <span class="keyword">then</span> <span class="dynexp">0</span> <span class="keyword">else</span> x * mult <span class="keyword">(</span>xs<span class="keyword">)</span>
<span class="keyword">|</span> nil0 <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="dynexp">1</span>
<span class="keyword">)</span></span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">exception</span> <span class="dynexp">ZERO <span class="keyword">of</span> <span class="keyword">(</span><span class="keyword">)</span></span>

<span class="dynexp"><span class="keyword">fun</span> mult3
  <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp">list0</span> <span class="keyword">(</span><span class="staexp">int</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">int</span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">//</span>
<span class="dynexp"><span class="keyword">fun</span> aux
  <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp">list0</span> <span class="keyword">(</span><span class="staexp">int</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">int</span> <span class="keyword">=</span>
<span class="keyword">case+</span> xs <span class="keyword">of</span>
<span class="keyword">|</span> cons0
    <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span>
    <span class="keyword">if</span> x <span class="keyword">=</span> <span class="dynexp">0</span> <span class="keyword">then</span> <span class="dynexp"><span class="keyword">$raise</span> ZERO</span> <span class="keyword">else</span> x * mult3 <span class="keyword">(</span>xs<span class="keyword">)</span>
<span class="keyword">|</span> nil0 <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="dynexp">1</span></span>
<span class="comment">//</span>
<span class="keyword">in</span>
<span class="comment">//</span>
<span class="dynexp"><span class="keyword">try</span>
  aux <span class="keyword">(</span>xs<span class="keyword">)</span>
<span class="keyword">with</span>
  <span class="keyword">|</span> <span class="keyword">~</span>ZERO <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> 0</span>
<span class="comment">//</span>
<span class="keyword">end</span></span> <span class="comment">// end of [mult3]</span>

<span class="comment">(* ****** ****** *)</span>

<span class="dynexp"><span class="keyword">implement</span>
main0 <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span>
<span class="keyword">{</span>
<span class="dynexp"><span class="keyword">val</span> xs <span class="keyword">=</span>
  <span class="keyword">$list</span><span class="keyword">{</span><span class="staexp">int</span><span class="keyword">}</span><span class="keyword">(</span><span class="dynexp">1</span><span class="keyword">,</span> <span class="dynexp">2</span><span class="keyword">,</span> <span class="dynexp">0</span><span class="keyword">,</span> <span class="dynexp">3</span><span class="keyword">,</span> <span class="dynexp">4</span><span class="keyword">,</span> <span class="dynexp">5</span><span class="keyword">)</span></span>
<span class="dynexp"><span class="keyword">val</span> xs <span class="keyword">=</span> list0_of_list <span class="keyword">(</span>xs<span class="keyword">)</span></span>
<span class="comment">//</span>
<span class="dynexp"><span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="dynexp">println!</span> <span class="keyword">(</span><span class="dynstr">"mult("</span><span class="keyword">,</span> xs<span class="keyword">,</span> <span class="dynstr">") = "</span><span class="keyword">,</span> mult <span class="keyword">(</span>xs<span class="keyword">)</span><span class="keyword">)</span></span>
<span class="dynexp"><span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="dynexp">println!</span> <span class="keyword">(</span><span class="dynstr">"mult2("</span><span class="keyword">,</span> xs<span class="keyword">,</span> <span class="dynstr">") = "</span><span class="keyword">,</span> mult2 <span class="keyword">(</span>xs<span class="keyword">)</span><span class="keyword">)</span></span>
<span class="dynexp"><span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="dynexp">println!</span> <span class="keyword">(</span><span class="dynstr">"mult3("</span><span class="keyword">,</span> xs<span class="keyword">,</span> <span class="dynstr">") = "</span><span class="keyword">,</span> mult3 <span class="keyword">(</span>xs<span class="keyword">)</span><span class="keyword">)</span></span>
<span class="keyword">}</span></span> <span class="comment">(* end of [main0] *)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [exception.dats] *)</span>
</pre>
</body>
</html>
